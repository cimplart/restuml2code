######################
Public CanSm Interface
######################

'.. sectnum::

Structural Design
*****************

Source File Description
=======================

.. table::
    :align: left

    +---------------+------------+-------------------------------------------+
    | File:         | Generated: |  Description:                             |
    +===============+============+===========================================+
    | CanSM.h       |    Yes     | Main CanSM module header.                 |
    +---------------+------------+-------------------------------------------+
    | CanSM_Priv.h  |    Yes     | Private macros.                           |
    +---------------+------------+-------------------------------------------+
    | CanSM_Types.h |    Yes     | CanSM type declarations.                  |
    +---------------+------------+-------------------------------------------+


API Specification
*****************

Module Interface Constants
==========================

.. table::
    :align: left

    +----------------------------------+------------------------------------------------------------------------+
    | Constants Group:                 | Development Errors                                                     |
    +==================================+========================================================================+
    | Declared in:                     | CanSM.h                                                                |
    +----------------+-----------------+---------------+-------+------------------------------------------------+
    | Constants:     | CANSM_E_UNINIT                  | 0x01  | API service used without module initialization.|
    |                +---------------------------------+-------+------------------------------------------------+
    |                | CANSM_E_PARAM_POINTER           | 0x02  | API service called with wrong pointer.         |
    |                +---------------------------------+-------+------------------------------------------------+
    |                | CANSM_E_INVALID_NETWORK_HANDLE  | 0x03  | API service called with wrong parameter        |
    |                +---------------------------------+-------+------------------------------------------------+
    |                | CANSM_E_PARAM_CONTROLLER        | 0x04  | API service called with wrong parameter.       |
    |                +---------------------------------+-------+------------------------------------------------+
    |                | CANSM_E_NOT_IN_NO_COM           | 0x0B  | DeInit API service called when not all CAN     |
    |                |                                 |       | networks are in state CANSM_NO_COMMUNICATION.  |
    +----------------+---------------------------------+-------+------------------------------------------------+

.. table::
    :align: left

    +------------------------------------+----------------------------------------------------------------+
    | Constants Group:                   | Service IDs                                                    |
    +====================================+================================================================+
    | Declared in:                       | CanSM.h                                                        |
    +---------------+--------------------+---------------+------+-----------------------------------------+
    | Constants:    | CANSM_SERVICEID_INIT               | 0x00 | Service id for CanSM_Init               |
    |               +------------------------------------+------+-----------------------------------------+
    |               | CANSM_SERVICEID_REQUESTCOMMODE     | 0x02 | Service id for CanSM_RequestComMode     |
    |               +------------------------------------+------+-----------------------------------------+
    |               | CANSM_SERVICEID_GETCURRENTCOMMODE  | 0x03 | Service id for CanSM_GetCurrentComMode  |
    |               +------------------------------------+------+-----------------------------------------+
    |               | CANSM_SERVICEID_CONTROLLERBUSOFF   | 0x04 | Service id for CanSM_ControllerBusOff   |
    +---------------+------------------------------------+------+-----------------------------------------+


.. table::
    :align: left

    +------------------+---------------------------------------------------------------------------------------------------------------------------------+
    | Constants Group: | Calculated constants                                                                                                            |
    +==================+=================================================================================================================================+
    | Declared in:     | CanSM.h                                                                                                                         |
    +------------------+---------------------------------+---------------------------------------------------------------+-------------------------------+
    | Constants:       | CANSM_MAX_DLT_STD_HEADER_SIZE   |                                                               | Size of standard DLT header.  |
    |                  |                                 |  (CANSM_DLT_STD_HEADER_SIZE +                                 |                               |
    |                  |                                 |  CANSM_DLT_HEADER_USE_EXT * CANSM_DLT_STD_ECU_ID_SIZE +       |                               |
    |                  |                                 |  CANSM_DLT_HEADER_USE_SESID * CANSM_DLT_STD_SES_ID_SIZE +     |                               |
    |                  |                                 |  CANSM_DLT_HEADER_USE_TIME * CANSM_DLT_STD_TIME_SIZE)         |                               |
    |                  +---------------------------------+---------------------------------------------------------------+-------------------------------+
    |                  | CANSM_MAX_DLT_HEADER_SIZE       | (CANSM_MAX_DLT_STD_HEADER_SIZE +                              | Total header size.            |
    |                  |                                 | CANSM_DLT_HEADER_USE_EXT * CANSM_DLT_EXT_HEADER_SIZE)         |                               |
    |                  +---------------------------------+---------------------------------------------------------------+-------------------------------+
    |                  | CANSM_MAX_DLT_BUFFER_SIZE       | (CANSM_MAX_DLT_MSG_SIZE * CANSM_MAX_MESSAGES_IN_BUFFER)       | Total DLT buffer size.        |
    +------------------+---------------------------------+---------------------------------------------------------------+-------------------------------+


Module Interface Function-like Macros
=====================================

.. table::
    :align: left

    +--------------------------+--------------------------------------------------------------------------+
    | Identifier name:         | CANSM_DET_REPORTERROR                                                    |
    +==========================+==========================================================================+
    | Description:             | Service to report development errors                                     |
    +--------------------------+--------------------------------------------------------------------------+
    | Syntax:                  | .. code-block::                                                          |
    |                          |                                                                          |
    |                          |   #define CANSM_DET_REPORTERROR(ApiId, ErrorId)                          |
    +--------------------------+--------------------------------------------------------------------------+
    | Declared in:             | CanSM_Priv.h                                                             |
    +--------------------------+--------------------------------------------------------------------------+
    | May be called from ISR:  | Yes                                                                      |
    +--------------------------+--------------------------------------------------------------------------+
    | Reentrancy:              | Reentrant                                                                |
    +--------------------------+------------------+-------------------------------------------------------+
    | Return value:            | Std_ReturnType   | See description of Det_ReportError.                   |
    +--------------------------+--------------+---+-------------------------------------------------------+
    | Parameters [in]:         | ApiId        | ID of CanSM API service in which error is detected.       |
    |                          +--------------+-----------------------------------------------------------+
    |                          | ErrorId      | ID of detected CanSM development error                    |
    +--------------------------+--------------+-----------------------------------------------------------+
    | Definition:              | Condition:   | ``CANSM_DEV_ERROR_DETECT == STD_ON &&                     |
    |                          |              | CANSM_DEV_TEST == STD_OFF``                               |
    |                          +--------------+-----------------------------------------------------------+
    |                          | Code:        | .. code-block::                                           |
    |                          |              |                                                           |
    |                          |              |   Det_ReportError(MODULE_ID_CANSM, 0, serviceId, errorId) |
    |                          +--------------+-----------------------------------------------------------+
    |                          | Condition:   | ``CANSM_DEV_ERROR_DETECT == STD_ON &&                     |
    |                          |              | CANSM_DEV_TEST == STD_ON``                                |
    |                          +--------------+-----------------------------------------------------------+
    |                          | Code:        | .. code-block::                                           |
    |                          |              |                                                           |
    |                          |              |   CANSM_TEST_CHECK_ERROR(serviceId, errorId);  \          |
    |                          |              |   Det_ReportError(MODULE_ID_CANSM, 0, serviceId, errorId) |
    |                          +--------------+-----------------------------------------------------------+
    |                          | Condition:   | default                                                   |
    |                          +--------------+-----------------------------------------------------------+
    |                          | Code:        | .. code-block::                                           |
    |                          |              |                                                           |
    |                          |              |   /* No code */                                           |
    +--------------------------+--------------+-----------------------------------------------------------+

.. table::
    :align: left

    +--------------------------+--------------------------------------------------------------------------+
    | Identifier name:         | DEM_REPORT_ERROR_STATUS                                                  |
    +==========================+==========================================================================+
    | Description:             | Service to report diagnostic events.                                     |
    +--------------------------+--------------------------------------------------------------------------+
    | Syntax:                  | .. code-block::                                                          |
    |                          |                                                                          |
    |                          |   #define DEM_REPORT_ERROR_STATUS(Event, Eventstatus)                    |
    +--------------------------+--------------------------------------------------------------------------+
    | Declared in:             | CanSM_Priv.h                                                             |
    +--------------------------+--------------------------------------------------------------------------+
    | May be called from ISR:  | No                                                                       |
    +--------------------------+--------------------------------------------------------------------------+
    | Reentrancy:              | Reentrant for different EventIds. Non reentrant for the same EventId.    |
    +--------------------------+------------------+-------------------------------------------------------+
    | Return value:            | Std_ReturnType   | See description of Det_ReportError.                   |
    +--------------------------+--------------+---+-------------------------------------------------------+
    | Parameters [in]:         | Event        | Identification of an event by assigned Event ID.          |
    |                          +--------------+-----------------------------------------------------------+
    |                          | EventStatus  | Monitor test result                                       |
    +--------------------------+--------------+-----------------------------------------------------------+
    | Definition:              |  Code:       | .. code-block::                                           |
    |                          |              |                                                           |
    |                          |              |    Dem_ReportErrorStatus(Event, EventStatus)              |
    +--------------------------+--------------+-----------------------------------------------------------+


Module Interface Types
======================

CanSM_BswMCurrentStateType
--------------------------

.. table::
    :align: left

    +--------------+----------------------------------------------------------------------------+
    | Type name:   | CanSM_BswMCurrentStateType                                                 |
    +==============+============================================================================+
    | Description: | Can specific communication modes / states notified to the BswM module.     |
    +--------------+----------------------------------------------------------------------------+
    | Kind:        | Enumeration                                                                |
    +--------------+----------------------------------------------------------------------------+
    | Declared in: | CanSM_Types.h                                                              |
    +--------------+----------------------------------+------+----------------------------------+
    | Constants:   | CANSM_BSWM_NO_COMMUNICATION      |  0   | No communication.                |
    |              +----------------------------------+------+----------------------------------+
    |              | CANSM_BSWM_SILENT_COMMUNICATION  |      | Silent communication.            |
    |              +----------------------------------+------+----------------------------------+
    |              | CANSM_BSWM_FULL_COMMUNICATION    |      | Full communication               |
    |              +----------------------------------+------+----------------------------------+
    |              | CANSM_BSWM_BUS_OFF               |      | CAN Bus is switched off.         |
    +--------------+----------------------------------+------+----------------------------------+

