:module: Mod

Private Structural Design
*************************

Source File Description
=======================

.. table::
    :align: left

    +--------------+------------+---------------------------------------------+
    | File:        | Generated: |  Description:                               |
    +==============+============+=============================================+
    | mod_priv.h   |    Yes     | Private static declarations.                |
    +--------------+------------+---------------------------------------------+
    | mod.c        |    No      | Module implementation code.                 |
    +--------------+------------+---------------------------------------------+
    | mod_a.h      |    Yes     | Private extern declarations of submodule A  |
    +--------------+------------+---------------------------------------------+
    | mod_a_priv.h |    Yes     | Private declarations of submodule A         |
    +--------------+------------+---------------------------------------------+
    | mod_a.c      |    No      | Submodule a implementation code.            |
    +--------------+------------+---------------------------------------------+

Source File Dependencies
========================

.. uml::

    left to right direction

    artifact mod_priv.h <<header>>
    artifact mod_a.h <<header>>
    artifact mod_a_priv.h <<header>>
    artifact mod_a.c <<source>>
    artifact mod.c <<source>>

    mod.c ..> mod_priv.h : <<include>>
    mod.c ..> mod_a.h : <<include>>
    mod_a.c ..> mod_a.h : <<include>>
    mod_a.c ..> mod_a_priv.h : <<include>>

Private API
***********

Module Private Constants
========================

.. table::
    :align: left

    +----------------------------------+-------------------------------------------------------------------+
    | Constants Group:                 | Error codes                                                       |
    +==================================+===================================================================+
    | Declared in:                     | mod_a.h                                                           |
    +----------------+-----------------+----------+-------+------------------------------------------------+
    | Constants:     | MOD_A_ERROR_X              | 0x01  | Error X description                            |
    |                +----------------------------+-------+------------------------------------------------+
    |                | MOD_A_ERROR_Y              | 0x02  | Error Y description                            |
    +----------------+----------------------------+-------+------------------------------------------------+

.. table::
    :align: left

    +----------------------------------+-------------------------------------------------------------------+
    | Constants Group:                 | Mod_A internal constants                                          |
    +==================================+===================================================================+
    | Declared in:                     | mod_a_priv.h                                                      |
    +----------------+-----------------+----------+-------+------------------------------------------------+
    | Constants:     | RESULT_BUFFER_SIZE         | 4096  | Size of result buffer                          |
    |                +----------------------------+-------+------------------------------------------------+
    |                | DUMMY                      | 0x00  | Dummy constant                                 |
    +----------------+----------------------------+-------+------------------------------------------------+


Module Private Types
====================

.. table::
    :align: left

    +--------------+--------------------------------------------------------------------------------------------+
    | Type name:   | Mod_A_ExampleType                                                                          |
    +==============+============================================================================================+
    | Description: | Example type                                                                               |
    +--------------+--------------------------------------------------------------------------------------------+
    | Kind:        | Structure                                                                                  |
    +--------------+--------------------------------------------------------------------------------------------+
    | Declared in: | mod_a.h                                                                                    |
    +--------------+------------------------+------------------+------------------------------------------------+
    | Elements:    | bool                   | field1           | Description of field1                          |
    |              +------------------------+------------------+------------------------------------------------+
    |              | int32_t                | field2           | Description of field2                          |
    +--------------+------------------------+------------------+------------------------------------------------+

.. table::
    :align: left

    +--------------+----------------------------------------------------------------------------+
    | Type name:   | Mod_A_InternalState                                                        |
    +==============+============================================================================+
    | Description: | Example internal type                                                      |
    +--------------+----------------------------------------------------------------------------+
    | Kind:        | Enumeration                                                                |
    +--------------+----------------------------------------------------------------------------+
    | Declared in: | mod_a_priv.h                                                               |
    +--------------+----------------------------------+------+----------------------------------+
    | Constants:   | MOD_A_INITIAL                    |  0   | Initial state                    |
    |              +----------------------------------+------+----------------------------------+
    |              | MOD_A_IDLE                       |      | Idle state                       |
    |              +----------------------------------+------+----------------------------------+
    |              | MOD_A_PROCESSING                 |      | Processing input state           |
    +--------------+----------------------------------+------+----------------------------------+


Module Private Variables
========================

.. table::
    :align: left

    +-------------------------------+----------------------------------------------------------------------+
    | Variables Group:              | Mod_A state variables                                                |
    +===============================+======================================================================+
    | Declared in:                  | mod_a_priv.h                                                         |
    +----------------+--------------+----------------------------------------------------------------------+
    | Variables:     | Description: | Submodule instance state.                                            |
    |                +--------------+----------------------------------------------------------------------+
    |                | Syntax:      | .. code-block::                                                      |
    |                |              |                                                                      |
    |                |              |    static Mod_A_InternalState state = MOD_A_INITIAL                  |
    +----------------+--------------+----------------------------------------------------------------------+


.. table::
    :align: left

    +----------------------------------+-------------------------------------------------------------------+
    | Variables Group:                 | Mod_A internal buffers                                            |
    +==================================+===================================================================+
    | Declared in:                     | mod_a_priv.h                                                      |
    +----------------+-----------------+-------------------------------------------------------------------+
    | Variables:     | Description:    | Buffer to store processing results.                               |
    |                +-----------------+-------------------------------------------------------------------+
    |                | Syntax:         | .. code-block::                                                   |
    |                |                 |                                                                   |
    |                |                 |    static uint8_t resultBuffer[RESULT_BUFFER_SIZE] = {0}          |
    +                +-----------------+-------------------------------------------------------------------+
    |                | Description:    | Index of 1st unused byte in resultBuffer                          |
    |                +-----------------+-------------------------------------------------------------------+
    |                | Syntax:         | .. code-block::                                                   |
    |                |                 |                                                                   |
    |                |                 |    static uint8_t *resultFree = resultBuffer                      |
    +----------------+-----------------+-------------------------------------------------------------------+


Module Private Functions
========================

Mod_A_init
----------

.. table::
    :align: left

    +--------------------------+------------------------------------------------------------+
    | Function name:           | Mod_A_init                                                 |
    +==========================+============================================================+
    | Description:             | Function to initialize the submodule.                      |
    +--------------------------+------------------------------------------------------------+
    | Syntax:                  | .. code-block::                                            |
    |                          |                                                            |
    |                          |     void Mod_A_init(void)                                  |
    +--------------------------+------------------------------------------------------------+
    | Declared in:             | mod_a.h                                                    |
    +--------------------------+------------------------------------------------------------+
    | May be called from ISR:  | No                                                         |
    +--------------------------+------------------------------------------------------------+
    | Reentrancy:              | Non-Reentrant                                              |
    +--------------------------+------------------------------------------------------------+
    | Return value:            | None                                                       |
    +--------------------------+------------------------------------------------------------+

Mod_A_processInput
------------------

.. table::
    :align: left

    +--------------------------+------------------------------------------------------------+
    | Function name:           | Mod_A_processInput                                         |
    +==========================+============================================================+
    | Description:             | Function to process input data.                            |
    +--------------------------+------------------------------------------------------------+
    | Syntax:                  | .. code-block::                                            |
    |                          |                                                            |
    |                          |     int Mod_A_processInput(uint8_t data[], size_t len)     |
    |                          |                                                            |
    +--------------------------+------------------------------------------------------------+
    | Declared in:             | mod_a.h                                                    |
    +--------------------------+------------------------------------------------------------+
    | May be called from ISR:  | No                                                         |
    +--------------------------+------------------------------------------------------------+
    | Reentrancy:              | Non-Reentrant                                              |
    +--------------------------+----------+-------------------------------------------------+
    | Return value:            | int      | 0 if all OK, -1 on error and errno is set       |
    +--------------------------+----------+-------------------------------------------------+
    | Parameters [in]:         | data     | Data buffer to process.                         |
    |                          +----------+-------------------------------------------------+
    |                          | len      | Buffer length.                                  |
    +--------------------------+----------+-------------------------------------------------+


Module Private Static Functions
===============================

.. table::
    :align: left

    +--------------------------+----------------------------------------------------------------------+
    | Function name:           | dispatchInputChunk                                                   |
    +==========================+======================================================================+
    | Description:             | Function to process input data chunk.                                |
    +--------------------------+----------------------------------------------------------------------+
    | Syntax:                  | .. code-block::                                                      |
    |                          |                                                                      |
    |                          |    static int dispatchInputChunk(uint8_t chunk[], size_t chunk_len)  |
    |                          |                                                                      |
    +--------------------------+----------------------------------------------------------------------+
    | Declared in:             | mod_a_priv.h                                                         |
    +--------------------------+----------------------------------------------------------------------+
    | May be called from ISR:  | No                                                                   |
    +--------------------------+----------------------------------------------------------------------+
    | Reentrancy:              | Non-Reentrant                                                        |
    +--------------------------+-----------+----------------------------------------------------------+
    | Return value:            | int       | 0 if all OK, or an error code                            |
    +--------------------------+-----------+----------------------------------------------------------+
    | Parameters [in]:         | chunk     | Chunk of data to process.                                |
    |                          +-----------+----------------------------------------------------------+
    |                          | chunk_len | Buffer length.                                           |
    +--------------------------+-----------+----------------------------------------------------------+


Module Private Function-like Macros
===================================

.. table::
    :align: left

    +--------------------------+-----------------------------------------------------------+
    | Identifier name:         | MOD_A_REPORT_ERROR                                        |
    +==========================+===========================================================+
    | Description:             | Service to report errors.                                 |
    +--------------------------+-----------------------------------------------------------+
    | Syntax:                  | .. code-block::                                           |
    |                          |                                                           |
    |                          |   #define MOD_A_REPORT_ERROR(error_code)                  |
    +--------------------------+-----------------------------------------------------------+
    | Declared in:             | mod_a_priv.h                                              |
    +--------------------------+-----------------------------------------------------------+
    | May be called from ISR:  | No                                                        |
    +--------------------------+-----------------------------------------------------------+
    | Reentrancy:              | Non-reentrant                                             |
    +--------------------------+-----------------------------------------------------------+
    | Return value:            | None                                                      |
    +--------------------------+--------------+--------------------------------------------+
    | Parameters [in]:         | error_code   | The reported error code                    |
    +--------------------------+--------------+--------------------------------------------+
    | Definition:              |  Code:       | .. code-block::                            |
    |                          |              |                                            |
    |                          |              |    Log_error(error_code)                   |
    +--------------------------+--------------+--------------------------------------------+
